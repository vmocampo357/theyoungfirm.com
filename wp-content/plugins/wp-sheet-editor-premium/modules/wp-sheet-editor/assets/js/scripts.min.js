function vgseCustomTooltip(e,t,o,r){o||(o="bottom"),e.tipso({position:o,tooltipHover:!0,content:t}).tipso("show"),r&&(e.hover(function(){e.tipso("hide")}),setTimeout(function(){e.tipso("hide")},8e3)),setTimeout(function(){e.tipso("hide"),r||e.tipso("destroy")},8e3)}function beParseParams(e){for(var t={},o=e.split("&"),r=0;r<o.length;r++){var n=o[r].split("=");if(n[0]=decodeURIComponent(n[0]),n[1]=decodeURIComponent(n[1]),void 0===t[n[0]])t[n[0]]=n[1];else if("string"==typeof t[n[0]]){var a=[t[n[0]],n[1]];t[n[0]]=a}else t[n[0]].push(n[1])}return t}function beGetRowsFilters(){return jQuery("body").data("be-filters")?jQuery.param(jQuery("body").data("be-filters")):""}function beAddRowsFilter(e){if(!e)return!1;var t=jQuery("body").data("be-filters");t||(t={});var o="string"==typeof e?beParseParams(e):e,r=jQuery.extend(t,o),n=jQuery(".vgse-current-filters");return n.empty(),n.each(function(){var n=jQuery(this);jQuery.each(r,function(e,t){if(t&&e.indexOf("meta_query")<0){var o="string"==typeof t?t:t.join(", "),r=e.replace("[]","");n.append('<a href="#" class="button" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+r+": "+o+"</a>")}if(t&&-1<e.indexOf("meta_query")&&!n.find(".advanced-filter").length){e="meta_query",r="Advanced filter";n.append('<a href="#" class="button advanced-filter" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+r+"</a>")}})}),jQuery("body").data("be-filters",r),r}function beAjaxLoop(e){var o=jQuery.extend({totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,o){},status:"running"},e);function r(){if(o.current<o.totalCalls+1){if("running"!==o.status)return!0;jQuery.isArray(o.data)?o.data.push({name:"page",value:o.current}):o.data.page=o.current;var e={url:o.url,dataType:o.dataType,data:o.prepareData(o.data,o),method:o.method};jQuery.ajax(e).done(function(e){o.onSuccess(e,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))}).fail(function(e,t){o.onError(e,t,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))})}}return r(),{pause:function(){o.status="paused"},resume:function(){o.status="running",r()}}}function loading_ajax(e){"boolean"==typeof e&&(e={estado:e});var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)var e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else e="blue";jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),ohSnap(t.mensaje,{time:t.time,color:e})},500)}function beLoadPosts(t,o,r,n){loading_ajax({estado:!0}),r||(r=!0),n||(n=!1),t.action="vgse_load_data",t.filters=beGetRowsFilters(),jQuery.ajax({url:ajaxurl,dataType:"json",type:"POST",data:t,dataType:"json"}).success(function(e){if(jQuery("body").trigger("vgSheetEditor:beforeRowsInsert",[e,t,o,r,n]),"function"==typeof o&&(o(e),r))return!0;e.success?(vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows,null,n),notification({mensaje:vgse_editor_settings.texts.posts_loaded}),loading_ajax({estado:!1}),jQuery(".ht_clone_top.handsontable").remove()):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}),vgseAddFoundRowsCount(0))})}function beDeduplicateItems(e){var r=[],n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,t){var o="array"===n?t[0]:t.ID;"string"==typeof o&&(o=o.replace(/[^0-9]/gi,"")),r[o]||(r[o]=t)}),r}function beGetModifiedObjectProperties(t,o){var r={};return Object.keys(o).forEach(function(e){t&&void 0!==t[e]&&o[e]==t[e]||(r[e]=o[e])}),r}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var o=e.length;o--;)if(e[o]!==t[o])return!1;return!0}function beGetModifiedItems(n,a){n=beDeduplicateItems(n),a=beDeduplicateItems(a);var i=[],s=n[0]instanceof Array?"array":"object";return n.forEach(function(e,t){if("array"!==s||void 0!==a[t]&&beArraysIdenticalCheck(n[t],a[t])){if("object"===s){var r,o=beGetModifiedObjectProperties(a[t],n[t]);void 0!==a[t]&&jQuery.isEmptyObject(o)||(r=!a[t]||a[t].provider&&vgse_editor_settings.saveFullRowPostTypes&&-1<vgse_editor_settings.saveFullRowPostTypes.indexOf(a[t].provider)?n[t]:(o.ID=t,o),jQuery.each(r,function(e,t){if("string"==typeof t&&-1<t.indexOf("set_custom_images")){var o=jQuery("<div/>").html(t).find(".set_custom_images").attr("data-images");r[e]=o||""}}),i.push(r))}}else i.push(e)}),i}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))var e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else e="";return e}function vgseExecuteFunctionByName(e,t){for(var o=[].slice.call(arguments).splice(2),r=e.split("."),n=r.pop(),a=0;a<r.length;a++)t=t[r[a]];return t[n].apply(t,o)}function vgObjectToArray(e){var t=[];for(var o in e)t.push(e[o]);return t}function _debounce(t,o,r){var n,a,i,s,u,d=function(){var e=_now()-s;e<o&&0<=e?n=setTimeout(d,o-e):(n=null,r||(u=t.apply(i,a),n||(i=a=null)))};return function(){i=this,a=arguments,s=_now();var e=r&&!n;return n||(n=setTimeout(d,o)),e&&(u=t.apply(i,a),i=a=null),u}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(o,r,n){var a,i,s;r||(r=300);var u=null,d=0;n||(n={});var c=function(){d=!1===n.leading?0:_now(),u=null,s=o.apply(a,i),u||(a=i=null)};return function(){var e=_now();d||!1!==n.leading||(d=e);var t=r-(e-d);return a=this,i=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),d=e,s=o.apply(a,i),u||(a=i=null)):u||!1===n.trailing||(u=setTimeout(c,t)),s}}function vgseRemovePostFromSheet(r,e){var n=[];return r=parseInt(r),e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID.replace(/[^0-9]/gi,""))),r!==o.ID&&n.push(e)}),n}function vgAddRowsToSheet(e,t,o){t||(t="append"),e||(e=[]),"prepend"===t&&(e=e.reverse());var r=hot.getSourceData();for(o&&e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID.replace(/[^0-9]/gi,""))),r=vgseRemovePostFromSheet(o.ID,r)}),i=0;i<e.length;i++){hot.getDataAtCol(0).indexOf(e[i].ID)<0&&("append"===t?r.push(jQuery.extend(!0,{},e[i])):r.unshift(jQuery.extend(!0,{},e[i])))}hot.loadData(r),jQuery("body").trigger("vgSheetEditor:afterRowsInsert",[e,t,o]),window.beOriginalData||(window.beOriginalData=[]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function beSendImageIdToWP(r,e,t,o,n,a){setTimeout(function(){var o=[];jQuery.each(r,function(e,t){o.push(t.id)});var e=hot.getDataAtCell(n.row,n.col),t=jQuery("<div/>").html(e);t.find(".set_custom_images").text(vgse_editor_settings.texts.use_other_image),t.find(".set_custom_images").attr("data-images",o),t.find("img").attr("src",r[0].url),t.find(".hidden").removeClass("hidden"),hot.setDataAtCell(n.row,n.col,t.html()),"function"==typeof a&&a(response)},800)}function vgseInitSelect2(e){if(!e)e=jQuery("select.select2");e.each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0,allowClear:!0};jQuery(this).data("remote")&&(e.ajax={url:ajaxurl,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),output_format:jQuery(this).data("output-format"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery(this).data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:t.data("post-type"),nonce:e})}function vgseAddFoundRowsCount(e){window.beFoundRows=e,jQuery(".be-total-rows").text(jQuery(".be-total-rows").text().replace(/\d+/,e))}void 0===Array.prototype.chunk&&Object.defineProperty(Array.prototype,"chunk",{value:function(o){var r=this;return[].concat.apply([],r.map(function(e,t){return t%o?[]:[r.slice(t,t+o)]}))}}),jQuery(document).ajaxError(function(e,t,o,r){loading_ajax({estado:!1}),"abort"!==t.statusText&&(400==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_400,tipo:"error",tiempo:6e4}):403==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_403,tipo:"error",tiempo:6e4}):500==t.status||502==t.status||505==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}):503==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_503,tipo:"error",tiempo:6e4}):509==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_509,tipo:"error",tiempo:6e4}):504==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_504,tipo:"error",tiempo:6e4}):notification({mensaje:vgse_editor_settings.texts.http_error_default,tipo:"error",tiempo:6e4}))}),jQuery(document).ajaxComplete(function(e,t,o,r){"abort"!==t.statusText&&("0"===t.responseText||0===t.responseText||r)&&(loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}))});
jQuery(document).ready(function(e){if(jQuery("body").on("click",".wpse-toggle-head",function(){jQuery(this).next(".wpse-toggle-content").slideToggle()}),!jQuery(".be-spreadsheet-wrapper").length)return!0;function t(){var e=jQuery(window).scrollTop();jQuery("#vg-header-toolbar-placeholder").offset().top<e?(jQuery("#vg-header-toolbar").css("top",""),jQuery("#vg-header-toolbar").addClass("sticky"),jQuery("#wpadminbar").hide(),jQuery("#vg-header-toolbar-placeholder").height(jQuery("#vg-header-toolbar").outerHeight())):(jQuery("#wpadminbar").show(),jQuery("#vg-header-toolbar").removeClass("sticky"),jQuery("#vg-header-toolbar-placeholder").height(0))}vgseCustomTooltip(jQuery(".vg-toolbar .settings-container"),vgse_editor_settings.texts.settings_moved_submenu,"top"),jQuery(".vi-preview-wrapper").appendTo("body"),jQuery("body").on("mouseleave",".vi-preview-img",function(e){jQuery(".vi-preview-wrapper").hide()}),jQuery("body").on("mouseenter",".vi-preview-img",function(e){var t=jQuery(this).first(),a=(jQuery(this)[0].outerHTML,'<img src="'+t.attr("src")+'" />'),o=jQuery(".vi-preview-wrapper");jQuery(window).width()-o.width()<t.offset().left+t.width()-jQuery(document).scrollLeft()?o.css({right:"auto",left:"0px"}):o.css({right:"0px",left:"auto"}),o.empty(),o.show(),o.append(a)}),jQuery("#vg-header-toolbar").length&&(jQuery(window).scroll(_throttle(t,350)),t()),jQuery("#go-top").click(function(e){e.preventDefault(),jQuery("html, body").stop().animate({scrollTop:0},"300","swing",function(){})}),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>');var a=jQuery("#vgse-wrapper");a.length&&a.find(".vg-toolbar input:checkbox").labelauty(),jQuery("body").find(".tipso").tipso({size:"small",tooltipHover:!0,background:"#444444"});var p,r=jQuery("#post-data"),o=(jQuery("#responseConsole"),r.parent());jQuery("#formato").is(":checked")?format=!1:format=!0,setTimeout(function(){vgseInitSelect2()},2e3);var n={colWidths:vgObjectToArray(vgse_editor_settings.colWidths),colHeaders:vgObjectToArray(vgse_editor_settings.colHeaders),columns:d(format),rowHeaders:!0,startRows:vgse_editor_settings.startRows,startCols:vgse_editor_settings.startCols,currentRowClassName:"currentRow",currentColClassName:"currentCol",fillHandle:!1,columnSorting:!0,contextMenu:["undo","redo","---------","copy","cut","Paste using keyboard: Ctrl+V","---------","freeze_column","unfreeze_column"],autoWrapRow:!0,autoRowSize:!1,autoColumnSize:!1,viewportRowRenderingOffset:20,viewportColumnRenderingOffset:4,wordWrap:!0,minSpareCols:0,minSpareRows:0,width:null,height:null,manualColumnFreeze:!0,copyRowsLimit:99999999,copyColsLimit:99999999};vgse_editor_settings.debug&&(n.debug=vgse_editor_settings.debug);var i=vgse_editor_settings.custom_handsontable_args?JSON.parse(vgse_editor_settings.custom_handsontable_args):{},s=jQuery.extend(n,i);p=new Handsontable(r[0],s),window.hot=p,window.beFoundRows=0,o.find("button[name=load]").click(function(){var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:r.data("post-type"),nonce:e})}).click(),jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){t.success||vgseCustomTooltip(jQuery("#addrow"),vgse_editor_settings.texts.add_posts_here)}),jQuery(".bulk-save.remodal").find(".remodal-cancel").click(function(e){jQuery('[data-remodal-id="bulk-save"]').remodal().close(),jQuery("html,body").scrollLeft(0)}),jQuery(".bulk-save.remodal .bulk-saving-screen").find(".remodal-cancel").click(function(e){jQuery("html,body").scrollLeft(0);var t=jQuery(this),a=t.parents(".remodal");a.find(".be-saving-warning").show(),a.find(".bulk-saving-screen").hide(),a.find("#be-nanobar-container").empty(),t.addClass("hidden"),a.find(".response").empty()}),jQuery(".bulk-save.remodal").find(".remodal-confirm").click(function(e){var t=jQuery(this).parents(".remodal");t.find(".be-saving-warning").show(),t.find(".bulk-saving-screen").hide(),t.find("#be-nanobar-container").empty(),t.find(".response").empty()}),jQuery("body").find(".be-start-saving").click(function(e){e.preventDefault();var t=jQuery(this).parents(".be-saving-warning"),n=t.next();n.find(".be-loading-anim").show(),t.fadeOut(),n.fadeIn();var a=jQuery(".remodal-bg").data("nonce"),o={classname:"be-progress-bar",id:"be-progress-bar",target:document.getElementById("be-nanobar-container")},i=new Nanobar(o),s=p.getSourceData();if(!(s=beGetModifiedItems(s,window.beOriginalData)).length)return jQuery(n).find(".response").append("<p>"+vgse_editor_settings.texts.no_changes_to_save+"</p>"),loading_ajax({estado:!1}),n.find(".remodal-cancel").removeClass("hidden"),n.find(".be-loading-anim").hide(),setFormSubmitting(),!0;beAjaxLoop({totalCalls:Math.ceil(s.length/parseInt(vgse_editor_settings.save_posts_per_page)),url:ajaxurl,dataType:"json",method:"POST",data:{data:[],post_type:r.data("post-type"),action:"vgse_save_data",nonce:a,filters:beGetRowsFilters()},prepareData:function(e,t){var a=s.chunk(parseInt(vgse_editor_settings.save_posts_per_page));return e.data=a[t.current-1],e},onSuccess:function(e,t){if(!0===e.success||e.data||(e={data:{message:vgse_editor_settings.texts.http_error_try_now},success:!1}),!e.success)return jQuery(n).find(".response").append("<p>"+e.data.message+"</p>"),confirm(e.data.message)?(t.current=0,jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(jQuery(n).find(".response").append(vgse_editor_settings.texts.saving_stop_error),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!1);i.go(t.current/t.totalCalls*100);var a=parseInt(vgse_editor_settings.save_posts_per_page)*t.current>s.length?s.length:parseInt(vgse_editor_settings.save_posts_per_page)*t.current,o=(o=vgse_editor_settings.texts.paged_batch_saved.replace("{updated}",a)).replace("{total}",s.length);return jQuery(n).find(".response").append("<p>"+o+"</p>"),t.current===t.totalCalls&&(jQuery(n).find(".response").append("<p>"+vgse_editor_settings.texts.everything_saved+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.everything_saved}),n.find(".remodal-cancel").removeClass("hidden"),n.find(".be-loading-anim").hide(),jQuery("body").trigger("vgSheetEditor/afterSavingChanges"),setFormSubmitting(),window.beOriginalData=jQuery.extend(!0,{},p.getSourceData())),setTimeout(function(){jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight)},600),!0}})}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images:not(.multiple)","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var o=jQuery(this),t=o.parent("td"),n=p.getCoords(t[0]),i=jQuery("html,body").scrollLeft(),s=o.data("id"),r=o.data("key"),d=o.data("type"),a=o.data("file"),l=[],u=jQuery(document).scrollTop(),c=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),a=e.props.toJSON();a.url=a.url||"","image"===t&&a.url&&beSendImageIdToWP([{url:a.url,id:a.url}],s,r,t,n)}),media_uploader.on("open",function(){var e=media_uploader.state().get("selection"),t=a;t&&e.add(wp.media.attachment(t))}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(i),jQuery(window).scrollTop(u),jQuery("#infinito").prop("checked",c)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(i);var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models;if(!t.length)return!0;for(var a=0;a<e;a++)l.push({url:t[a].attributes.url,id:t[a].id});o.data("file",t[0].id),beSendImageIdToWP(l,s,r,d,n)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images.multiple","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),a=t.parent("td"),o=p.getCoords(a[0]),n=jQuery("html,body").scrollLeft(),i=t.data("id"),s=t.data("key"),r=t.data("type"),d=[],l=jQuery(document).scrollTop(),u=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!0}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),a=e.props.toJSON();a.url=a.url||"","image"===t&&a.url&&beSendImageIdToWP([{url:a.url,id:a.url}],i,s,t,o)}),media_uploader.on("close",function(){jQuery("html,body").scrollLeft(n),jQuery(window).scrollTop(l),jQuery("#infinito").prop("checked",u)}),media_uploader.on("insert",function(){jQuery("html,body").scrollLeft(n);for(var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models,a=0;a<e;a++)d.push({url:t[a].attributes.url,id:t[a].id});beSendImageIdToWP(d,i,s,r,o)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),jQuery("body").delegate(".view_custom_images:not(.multiple)","click",function(){loading_ajax({estado:!0});var e=jQuery(this);post_id=e.data("id");var t=jQuery(".remodal-bg").data("nonce"),a=e.data("key"),o=e.data("type"),n=e.siblings(".set_custom_images").data("images");jQuery.ajax({type:"POST",url:ajaxurl,data:{id:post_id,action:"vgse_get_image_preview",nonce:t,key:a,type:o,localValue:n,post_type:jQuery("#post-data").data("post-type")},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?(jQuery("div[data-remodal-id=image] .modal-content").html(e.data.message),jQuery("[data-remodal-id=image]").remodal()):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery("body").delegate(".view_custom_images.multiple","click",function(){loading_ajax({estado:!0});var e=jQuery(this);post_id=e.data("id");var t=jQuery(".remodal-bg").data("nonce"),a=e.data("key"),o=e.data("type"),n=e.siblings(".set_custom_images").data("images");jQuery.ajax({type:"POST",url:ajaxurl,data:{id:post_id,action:"vgse_get_gallery_preview",nonce:t,key:a,type:o,localValue:n,post_type:jQuery("#post-data").data("post-type")},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?(jQuery("div[data-remodal-id=image] .modal-content").html(e.data.message),jQuery("[data-remodal-id=image]").remodal()):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery("button.siguiente").click(function(){var e=jQuery(this),t=e.data("pos"),a=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+a).eq(t).trigger("click")}),jQuery("button.anterior").click(function(){var e=jQuery(this),t=e.data("pos"),a=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+a).eq(t).trigger("click")}),jQuery("body").delegate(".btn-popup-content","click",function(){loading_ajax({estado:!0});var e=jQuery(this),t=e.data("id"),a=e.data("key"),o=e.data("type"),n=e.parents("tr").index(),i=e.parents("tbody").find("tr").length,s=jQuery(".remodal-bg").data("nonce");0===n?(jQuery("button.anterior").hide(),jQuery("button.anterior").next(".tipso").hide()):(jQuery("button.anterior").show(),jQuery("button.anterior").next(".tipso").show()),n===i-1?(jQuery("button.siguiente").hide(),jQuery("button.siguiente").next(".tipso").hide()):(jQuery("button.siguiente").show(),jQuery("button.siguiente").next(".tipso").show()),jQuery("button.anterior").data("pos",n-1),jQuery("button.siguiente").data("pos",n+1),jQuery.ajax({type:"POST",url:ajaxurl,data:{pid:t,action:"vgse_get_wp_post_single_data",nonce:s,key:"post_title",type:"post_data",post_type:jQuery("#post-data").data("post-type")},dataType:"json",success:function(e){e.success?jQuery(".modal-tinymce-editor .post-title-modal span").text(e.data.message).show():jQuery(".modal-tinymce-editor .post-title-modal").hide()}}),jQuery.ajax({type:"POST",url:ajaxurl,data:{pid:t,action:"vgse_get_wp_post_single_data",nonce:s,key:a,type:o,post_type:jQuery("#post-data").data("post-type")},dataType:"json",success:function(e){if(e.success){if("none"!==jQuery(".wp-editor-area").css("display"))jQuery(".wp-editor-area").empty(),jQuery(".wp-editor-area").val(e.data.message);else if(document.getElementById("editpost_ifr"))(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML=e.data.message;window.originalTinyMCEData=beGetTinymceContent(),jQuery(".remodal2 .remodal-confirm").data("post_id",t),jQuery(".remodal2 .remodal-confirm").data("key",a),jQuery(".remodal2 .remodal-confirm").data("type",o),jQuery('[data-remodal-id="editor"]').remodal().open(),loading_ajax({estado:!1})}else notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery(".guardar-popup-tinymce").click(function(e){loading_ajax({estado:!0});var t=jQuery(".remodal2 .remodal-confirm");post_id=t.data("post_id"),key=t.data("key"),type=t.data("type");var a=beGetTinymceContent(),o=jQuery(".remodal-bg").data("nonce");!window.originalTinyMCEData||window.originalTinyMCEData&&a!==window.originalTinyMCEData?jQuery.ajax({type:"POST",url:ajaxurl,data:{post_id:post_id,content:a,action:"vgse_save_individual_post",nonce:o,key:key,type:type,post_type:jQuery("#post-data").data("post-type")},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?notification({mensaje:e.data.message}):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}}):loading_ajax({estado:!1})}),o.find("button[name=mas]").click(function(){jQuery("#formato").is(":checked")?format=!0:format=!1;var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:r.data("post-type"),paged:Math.ceil(p.countRows()/vgse_editor_settings.posts_per_page)+1,nonce:e},function(e){e.success?(vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.posts_loaded}),window.scrroll=!0,e.data&&e.data.rows.length||(window.scrroll=!1)):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}),window.scrroll=!1)})});jQuery("#post-data").offset();window.scrroll=!0;p.countRows();function d(e){if(!0===e)var t=vgse_editor_settings.columnsFormat;else t=vgse_editor_settings.columnsUnformat;return vgObjectToArray(t)}jQuery(window).on("scroll",_throttle(function(){jQuery("#infinito").is(":checked")&&jQuery(window).scrollTop()+jQuery(window).height()==jQuery(document).height()&&!0===window.scrroll&&scrollDown()&&(jQuery('button[name="mas"]').trigger("click"),window.scrroll=!1)},500)),jQuery("#formato").change(function(){jQuery(this).is(":checked")?format=!1:format=!0;var e=d(format);"function"==typeof vgseColumnsVisibilityUpdateHOT&&window.vgseColumnsVisibilityUsed?vgseColumnsVisibilityUpdateHOT(e,vgse_editor_settings.colHeaders,vgse_editor_settings.colWidth,"softUpdate"):p.updateSettings({columns:e})}),setInterval(function(){var e=p.countRows();jQuery('input[name="visibles"]').val(e)},1e3),jQuery("#addrow").click(function(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post_type_new_row").val(),a=jQuery(this).next(".number_rows").length&&jQuery(this).next(".number_rows").val()?parseInt(jQuery(this).next(".number_rows").val()):1;loading_ajax({estado:!0}),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"vgse_insert_individual_post",nonce:e,post_type:t,rows:a},dataType:"json",success:function(e){e.success?(vgseAddFoundRowsCount(window.beFoundRows+parseInt(a)),vgAddRowsToSheet(e.data.message,"prepend"),loading_ajax({estado:!1}),notification({mensaje:vgse_editor_settings.texts.new_rows_added}),jQuery(window).scrollTop(jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20)):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}))}})}),jQuery("#addrow2").click(function(){jQuery("#addrow").trigger("click")})});var lastScrollTop=0;function scrollDown(){var e=jQuery(window).scrollTop();return down=lastScrollTop<e,lastScrollTop=e,down}var formSubmitting=!1,setFormSubmitting=function(){formSubmitting=!0};function initHandsontableForPopup(e,t){if(e||(e=[]),"handsontable"===t.type){var a=t.handsontable_column_widths[t.post_type],o=t.handsontable_column_names[t.post_type],n=t.handsontable_columns[t.post_type],i=document.getElementById("handsontable-in-modal");window.hotAttr&&window.hotAttr.destroy();var s={data:e.custom_handsontable_args?e.data:e,minSpareRows:1,wordWrap:!0,colWidths:a,allowInsertRow:!0,columnSorting:!0,colHeaders:o,columns:n},r=jQuery.extend(s,e.custom_handsontable_args);window.hotAttr=new Handsontable(i,r)}else if("metabox"===t.type){var d=jQuery(".vgca-iframe-wrapper iframe");d.parents(".vgca-iframe-wrapper ").show(),d.attr("src",d.data("src")+t.post_id+"&wpse_column="+t.key),initEditorIframe(t)}loading_ajax({estado:!1})}function initEditorIframe(i){window.$iframeWrappers=jQuery(".vgca-iframe-wrapper "),window.vgcaIsFrontendSession=[],$iframeWrappers.each(function(){var o=jQuery(this),n=o.find("iframe");window.location.hash;n.data("lastPage",n.contents().get(0).location.href),window.vgcaIsFrontendSession.push(setInterval(function(){var e=n.contents().get(0).location.href;e!==n.data("lastPage")&&($iframeWrappers.css("height",""),n.css("height",""),n.data("lastPage",e));try{var t=n.contents().height();n.height(t),o.height(t);var a=n.contents().find(i.metabox_show_selector);a.removeClass("acf-hidden").removeClass("hidden").attr("hidden","").attr("style","display: block !important; visibility: 1 !important; opacity: 1 !important;"),a.siblings().attr("style","display: none !important"),a.parents().each(function(){jQuery(this).siblings().attr("style","display: none !important")})}finally{}},1e3))})}function vgsePostTypeSaved(e){e.response.success&&(jQuery(".post-types-form .post-type-field").first().before('<div class="post-type-field"><input type="radio" name="post_types[]" value="'+e.response.data.slug+'" id="'+e.response.data.slug+'"> <label for="'+e.response.data.slug+'">'+e.response.data.label+"</label></div>"),jQuery(".post-types-form input:radio").first().prop("checked",!0),jQuery(".post-types-form .save-trigger").trigger("click"))}function vgsePostTypeSetupPostTypesSaved(e){var t=e.form.parents("li");t.hide();var a=t.next();a.show(),a.hasClass("setup_columns")&&jQuery.get(ajaxurl,{action:"vgse_post_type_setup_columns_visibility",nonce:jQuery(".post-type-setup-wizard").data("nonce"),post_type:jQuery(".post-types-form input:radio:checked").val()},function(e){a.append(e.data.html),a.find('[name="save_post_type_settings"]').prop("checked",!0),"undefined"!=typeof vgseColumnsVisibilityInit&&vgseColumnsVisibilityInit()})}function vgsePostTypeSetupColumnSaved(e){jQuery("#vgse-columns-enabled").append('<li><span class="handle">::</span> '+e.response.data.label+' <input type="hidden" name="columns[]" class="js-column-key" value="'+e.response.data.key+'"><input type="hidden" name="columns_names[]" class="js-column-title" value="'+e.response.data.label+'"></li>')}function vgsePostTypeSetupColumnsVisibilitySaved(e){window.location.href=e.response.data.post_type_editor_url}jQuery(window).on("beforeunload",function(){if(jQuery(".be-spreadsheet-wrapper").length)var e=beGetModifiedItems(hot.getSourceData(),window.beOriginalData);else e=[];if(jQuery(".be-spreadsheet-wrapper").length&&e.length&&!formSubmitting)return vgse_editor_settings.texts.save_changes_on_leave}),jQuery(document).ready(function(){var e=jQuery(".quick-setup-page-content");if(!e.length)return!0;function i(){jQuery(".setup-step.active").removeClass("active").next().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").next().addClass("active")}e.find(".step-back").click(function(e){e.preventDefault(),jQuery(".setup-step.active").removeClass("active").prev().addClass("active"),jQuery(" #vgse-wrapper .progressbar li.active").removeClass("active").prev().addClass("active")}),e.find(".save-all-trigger").click(function(e){e.preventDefault();var t=jQuery(this).parents(".setup-step"),a=t.find("form");if(loading_ajax({estado:!0}),!a.length)return i(),loading_ajax({estado:!1}),!0;t.find(".save-trigger").each(function(){jQuery(this).trigger("click")});var o=t.find(".save-trigger").length,n=setInterval(function(){t.find(".save-trigger").filter(function(){return"yes"===jQuery(this).data("saved")}).length===o&&(clearInterval(n),i(),loading_ajax({estado:!1}))},800)}),e.find(".save-trigger").click(function(e){e.preventDefault();var t=jQuery(this),a=t.parents("form"),o=a.data("callback");jQuery.post(a.attr("action"),a.serializeArray(),function(e){t.data("saved","yes"),o&&vgseExecuteFunctionByName(o,window,{response:e,form:a})})})}),jQuery(document).ready(function(){jQuery("body").on("click",".form-submit-outside",function(e){e.preventDefault(),jQuery(this).parents(".remodal").find("form .form-submit-inside").trigger("click")}),jQuery(document).on("opened",".remodal",function(){var e=jQuery(document).scrollTop(),t=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),jQuery("body").data("temp-status",t).data("temp-scrolltop",e);var a=jQuery("html,body").scrollLeft();jQuery("body").data("temp-scrollleft",a)}),jQuery(document).on("closed",".remodal",function(){var e=jQuery("body").data("temp-scrolltop"),t=jQuery("body").data("temp-scrollleft"),a=jQuery("body").data("temp-status");e&&jQuery(window).scrollTop(e),t&&jQuery("html,body").scrollLeft(t),a&&jQuery("#infinito").prop("checked",a)})}),jQuery(document).ready(function(){jQuery("body").on("click",".button-custom-modal-editor",function(e){e.preventDefault();var t,a=jQuery(this),o=a.data();window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[o.modalSettings.post_id]||(window.hotModalCache[o.modalSettings.post_id]={}),t=window.hotModalCache&&window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]?window.hotModalCache[o.modalSettings.post_id][o.modalSettings.edit_modal_save_action]:o.existing;var n={button:a,modalSettings:o.modalSettings,existing:t};window.vgseWCAttsCurrent=n;jQuery(".custom-modal-editor").remodal().open();jQuery(".custom-modal-editor").addClass("modal-editor-"+o.modalSettings.key)}),jQuery("body").on("click",".custom-modal-editor .remodal-cancel",function(e){var t=jQuery(this).parents(".custom-modal-editor"),a=window.vgseWCAttsCurrent;a.modalSettings.edit_modal_cancel_action&&(loading_ajax({estado:!0}),a.modalSettings.edit_modal_cancel_action.replace("js_function_name:","").split(",").forEach(function(e){vgseExecuteFunctionByName(e,t.find("iframe")[0].contentWindow)}),loading_ajax(!1))}),jQuery("body").on("click",".custom-modal-editor .save-changes-handsontable",function(e){var a=jQuery(this).parents(".custom-modal-editor"),o=jQuery(".remodal-bg").data("nonce"),n=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),"handsontable"===n.modalSettings.type)var i=hotAttr.getSourceData();else if("metabox"===n.modalSettings.type)if(-1<n.modalSettings.metabox_value_selector.indexOf("js_function_name:")){var t=n.modalSettings.metabox_value_selector.replace("js_function_name:","");i=vgseExecuteFunctionByName(t,a.find("iframe")[0].contentWindow)}else{var s=a.find("iframe").contents().find(n.modalSettings.metabox_value_selector);i=1===s.length?s.val():beParseParams(s.serialize())}window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[n.modalSettings.post_id]||(window.hotModalCache[n.modalSettings.post_id]={}),n.modalSettings.edit_modal_get_action||(n.button.data("existing",i),window.hotModalCache[n.modalSettings.post_id][n.modalSettings.edit_modal_save_action]=i),n.modalSettings.edit_modal_save_action.split(",").forEach(function(e){if(-1<e.indexOf("js_function_name:")){var t=e.replace("js_function_name:","");vgseExecuteFunctionByName(t,a.find("iframe")[0].contentWindow)}else jQuery.post(ajaxurl,{action:e,nonce:o,postId:n.modalSettings.post_id,postType:n.modalSettings.post_type,modalSettings:n.modalSettings,data:i},function(e){})}),jQuery(".custom-modal-editor").remodal().close(),loading_ajax({estado:!1})}),jQuery(document).on("closed",".custom-modal-editor",function(){var e=window.vgseWCAttsCurrent,t=jQuery(".custom-modal-editor");"metabox"===e.modalSettings.type&&void 0!==window.vgcaIsFrontendSession&&window.vgcaIsFrontendSession.length&&(t.find("iframe").attr("src",""),t.find(".vgca-iframe-wrapper ").hide(),window.vgcaIsFrontendSession.forEach(function(e,t){clearInterval(e)})),jQuery(".custom-modal-editor").removeClass("modal-editor-"+e.modalSettings.key),loading_ajax({estado:!1})}),jQuery(document).on("opened",".custom-modal-editor",function(){var t=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),!t)return!0;var e=jQuery(".custom-modal-editor");if(e.find(".modal-post-title").length||e.find(".modal-general-title").after('<span class="modal-post-title"></span>'),e.find(".modal-post-title").html(t.modalSettings.post_title),t.modalSettings.edit_modal_title&&e.find(".modal-general-title").html(t.modalSettings.edit_modal_title+": "),t.modalSettings.edit_modal_description&&e.find(".modal-description").html(t.modalSettings.edit_modal_description),window.hotModalCache||(window.hotModalCache={}),window.hotModalCache[t.modalSettings.post_id]||(window.hotModalCache[t.modalSettings.post_id]={}),t.modalSettings.edit_modal_get_action){var a=jQuery(".remodal-bg").data("nonce");jQuery.get(ajaxurl,{action:t.modalSettings.edit_modal_get_action,nonce:a,postId:t.modalSettings.post_id}).done(function(e){initHandsontableForPopup(e.data,t.modalSettings)})}else{if(window.hotModalCache&&window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action])var o=window.hotModalCache[t.modalSettings.post_id][t.modalSettings.edit_modal_save_action];else o=t.existing;initHandsontableForPopup(o,t.modalSettings)}}),jQuery("body").on("click","button.remodal-confirm, a.remodal-cancel, .media-button-insert",function(e){"submit"===jQuery(this).attr("type")||jQuery(this).hasClass("submit")||e.preventDefault()})}),jQuery(document).ready(function(){jQuery(".vgse-current-filters").on("click",".button",function(e){e.preventDefault();var t=jQuery(this),a=hot.getSourceData();if((a=beGetModifiedItems(a,window.beOriginalData)).length)return alert(vgse_editor_settings.texts.save_changes_before_remove_filter),!0;var o=t.data("filter-key");if(o&&-1<o.indexOf("meta_query")){var n=jQuery("body").data("be-filters"),i={};jQuery.each(n,function(e,t){e&&-1<e.indexOf("meta_query")&&(i[e]="")})}else i=o+"=";beAddRowsFilter(i),t.remove(),vgseReloadSpreadsheet()})}),jQuery(document).ready(function(){var a=jQuery(".post-type-setup-wizard");if(!a.length)return!1;a.find("form.inline-add").submit(function(e){var t=jQuery(this),a=t.data("callback");return jQuery.ajax({method:t.attr("method"),url:t.attr("action"),data:t.serialize()+"&current_post_type="+jQuery(".post-types-form input:radio:checked").val()}).done(function(e){t.find("input:text").val(""),t.find("input:text").first().focus(),vgseExecuteFunctionByName(a,window,{response:e,form:t})}),!1});var e=a.find(".post-types-form").data("custom-post-types").split(",");jQuery.each(e,function(e,t){a.find(".post-types-form .post-type-"+t).append('<button class="button vgse-delete-post-type" data-post-type="'+t+'"><i class="fa fa-remove"></i></button>')}),a.on("click",".vgse-delete-post-type",function(e){e.preventDefault();var t=jQuery(this).data("post-type");if(!confirm(a.find(".post-types-form").data("confirm-delete")))return!0;jQuery.post(ajaxurl,{post_type:t,action:"vgse_delete_post_type",nonce:jQuery(".post-type-setup-wizard").data("nonce")},function(e){e.success&&(notification({mensaje:e.data.message,tipo:"success",tiempo:3e3}),a.find(".post-types-form .post-type-"+t).remove())})})}),jQuery(document).ready(function(){var t=jQuery(".quick-setup-page-content .post-type-field input");if(!t.length)return!1;var a=jQuery(".quick-setup-page-content .post-types-enabled");t.change(function(e){a.empty(),t.each(function(){var e=jQuery(this).val();if(jQuery(this).is(":checked")){var t='<a class="button post-type-'+e+'" href="admin.php?page=vgse-bulk-edit-'+e+'">Edit '+jQuery(this).siblings("label").text()+"</a> - ";a.append(t)}})})});
jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;hot.updateSettings({afterLoadData:function(t){},cells:function(t,e,n){var o={};if(vgse_editor_settings.watch_cells_to_lock||"post_status"===n||"post_mime_type"===n){var r=hot.getDataAtCell(t,e);r&&"string"==typeof r&&-1<r.indexOf("vg-cell-blocked")&&(o.readOnly=!0,o.editor=!1,o.renderer="html",o.fillHandle=!1)}return o}})});